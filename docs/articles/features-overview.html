<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Overview of seqR features • seqR</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Overview of seqR features">
<meta property="og:description" content="seqR">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">seqR</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.0.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/features-overview.html">Overview of seqR features</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/slowikj/seqR/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><script src="features-overview_files/header-attrs-2.9/header-attrs.js"></script><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Overview of seqR features</h1>
                        <h4 class="author">Jadwiga Słowik</h4>
            
            <h4 class="date">2021-09-13</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/slowikj/seqR/blob/master/vignettes/features-overview.Rmd"><code>vignettes/features-overview.Rmd</code></a></small>
      <div class="hidden name"><code>features-overview.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level2">
<h2 class="hasAnchor">
<a href="#introduction" class="anchor"></a>Introduction</h2>
<p>This vignette provides comprehensive overview of the features provided by <code>seqR</code> package with appropriate examples.</p>
<p>The package consists of two functions that facilitate k-mer counting:</p>
<ul>
<li>
<code>count_kmers</code> (used for counting k-mers of one type)</li>
<li>
<code>count_multimers</code> (a wrapper of <code>count_kmers</code>, used for counting k-mers of many types in a single invocation of the function)</li>
</ul>
<p>and one function that facilitates processing of k-mer matrices:</p>
<ul>
<li>
<code>rbind_columnwise</code> (a helper function used for merging several k-mer matrices that do not have same sets of columns)</li>
</ul>
</div>
<div id="supported-input-sequences" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-input-sequences" class="anchor"></a>Supported input sequences</h2>
<p>The package supports all types of biological sequences, in particular, nucleic acids and proteins. In fact, there is no constraint regarding the domain of input. However, input sequences must conform to the one of the following representations.</p>
<div id="string-vectors" class="section level3">
<h3 class="hasAnchor">
<a href="#string-vectors" class="anchor"></a>String vectors</h3>
<p>Example:</p>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAA"</span>, <span class="st">"ACDA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; 2 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      A.A_0 C.D_0 A.C_0 D.A_0</span>
<span class="co">#&gt; [1,]     2     .     .     .</span>
<span class="co">#&gt; [2,]     .     1     1     1</span></code></pre></div>
<p>This representation is more efficient and recommended to use. However, it does not support multi-character alphabets, as opposed to the second representation.</p>
</div>
<div id="list-of-string-vectors" class="section level3">
<h3 class="hasAnchor">
<a href="#list-of-string-vectors" class="anchor"></a>List of string vectors</h3>
<p>Example:</p>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"A"</span>, <span class="st">"A"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"C"</span>, <span class="st">"D"</span>, <span class="st">"A"</span><span class="op">)</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">2</span><span class="op">)</span>
<span class="co">#&gt; 2 x 4 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      A.A_0 D.A_0 A.C_0 C.D_0</span>
<span class="co">#&gt; [1,]     2     .     .     .</span>
<span class="co">#&gt; [2,]     .     1     1     1</span></code></pre></div>
</div>
</div>
<div id="supported-variants-of-k-mers" class="section level2">
<h2 class="hasAnchor">
<a href="#supported-variants-of-k-mers" class="anchor"></a>Supported variants of k-mers</h2>
<p>A user explicitly specifies k-mer configuration using the following function parameters: <code>k</code>, <code>kmer_gaps</code>, and <code>positional</code> (for <code>count_kmers</code>). There are four major variants of k-mers: <strong>contiguous k-mers</strong>, <strong>gapped k-mers</strong>, <strong>positional contiguous k-mers</strong>, and <strong>positional gapped k-mers</strong>.</p>
<div id="contiguous-k-mers" class="section level3">
<h3 class="hasAnchor">
<a href="#contiguous-k-mers" class="anchor"></a>Contiguous k-mers</h3>
<p>Contiguous k-mers can be defined as subwords of a fixed length. A user specifies the length of a k-mer with <code>k</code> parameter. The other function parameters should be <code>kmer_gaps = NULL</code> (default) and <code>positional = FALSE</code> (default).</p>
<p>For example, 3-mers of sequence AABC are: AAB and ABC.</p>
<div id="usage" class="section level4">
<h4 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DDDVSVAA"</span>, <span class="st">"FFSFSVAAA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">5</span><span class="op">)</span>
<span class="co">#&gt; 2 x 9 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      D.D.V.S.V_0.0.0.0 D.D.D.V.S_0.0.0.0 V.S.V.A.A_0.0.0.0 D.V.S.V.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                 1                 1                 1                 1</span>
<span class="co">#&gt; [2,]                 .                 .                 .                 .</span>
<span class="co">#&gt;      F.S.F.S.V_0.0.0.0 F.S.V.A.A_0.0.0.0 F.F.S.F.S_0.0.0.0 S.V.A.A.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                 .                 .                 .                 .</span>
<span class="co">#&gt; [2,]                 1                 1                 1                 1</span>
<span class="co">#&gt;      S.F.S.V.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                 .</span>
<span class="co">#&gt; [2,]                 1</span></code></pre></div>
</div>
</div>
<div id="gapped-k-mers" class="section level3">
<h3 class="hasAnchor">
<a href="#gapped-k-mers" class="anchor"></a>Gapped k-mers</h3>
<p>Gapped k-mers can be defined as subsequences (not necessarily contiguous) of a given sequence. In particular, between two contiguous elements of the sequence there might be a gap of the length specified by a user.</p>
<p>A user specifies the length of each gap separately using <code>kmer_gaps</code> parameter. The other function parameters should be <code>k = length(kmer_gaps) + 1</code> (default) and <code>positional = FALSE</code> (default).</p>
<p>For example, gapped 3-mers with gaps’ lengths 0 and 1 of sequence AABCCA are: AAC, ABC, BCA.</p>
<div id="usage-1" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-1" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb4"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DDDVSVAA"</span>, <span class="st">"FFSFSVAAA"</span><span class="op">)</span>,
            kmer_gaps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span><span class="op">)</span> <span class="co"># gapped 3-mer template: X__XX</span>
<span class="co">#&gt; 2 x 9 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      D.S.V_2.0 D.V.A_2.0 D.V.S_2.0 V.A.A_2.0 S.V.A_2.0 F.S.V_2.0 F.F.S_2.0</span>
<span class="co">#&gt; [1,]         1         1         1         1         .         .         .</span>
<span class="co">#&gt; [2,]         .         .         .         .         1         1         1</span>
<span class="co">#&gt;      S.A.A_2.0 F.A.A_2.0</span>
<span class="co">#&gt; [1,]         .         .</span>
<span class="co">#&gt; [2,]         1         1</span></code></pre></div>
</div>
</div>
<div id="positional-contiguous-k-mers" class="section level3">
<h3 class="hasAnchor">
<a href="#positional-contiguous-k-mers" class="anchor"></a>Positional contiguous k-mers</h3>
<p>A positional contiguous k-mer is a subtype of a contiguous k-mer with extra information related to the exact (start) position of the k-mer. It means that two same contiguous k-mers that start at different positions of a given sequence are considered to be different, as opposed to (non-positional) contiguous k-mers.</p>
<p>A user specifies the length of the k-mer with <code>k</code> parameter. The other function parameters should be <code>kmer_gaps = NULL</code> (default) and <code>positional = TRUE</code>.</p>
<p>For example, positional contiguous 3-mers of sequence AABCCA are: 1_AAB, 2_ABC, 3_BCC, 4_CCA.</p>
<div id="usage-2" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-2" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DDDVSVAA"</span>, <span class="st">"FFSFSVAAA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">5</span>,
            positional<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 9 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      1_D.D.D.V.S_0.0.0.0 2_D.D.V.S.V_0.0.0.0 4_V.S.V.A.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                   1                   1                   1</span>
<span class="co">#&gt; [2,]                   .                   .                   .</span>
<span class="co">#&gt;      3_D.V.S.V.A_0.0.0.0 2_F.S.F.S.V_0.0.0.0 4_F.S.V.A.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                   1                   .                   .</span>
<span class="co">#&gt; [2,]                   .                   1                   1</span>
<span class="co">#&gt;      3_S.F.S.V.A_0.0.0.0 1_F.F.S.F.S_0.0.0.0 5_S.V.A.A.A_0.0.0.0</span>
<span class="co">#&gt; [1,]                   .                   .                   .</span>
<span class="co">#&gt; [2,]                   1                   1                   1</span></code></pre></div>
</div>
</div>
<div id="positional-gapped-k-mers" class="section level3">
<h3 class="hasAnchor">
<a href="#positional-gapped-k-mers" class="anchor"></a>Positional gapped k-mers</h3>
<p>A positional gapped k-mer is a subtype of a gapped k-mer with extra information about the exact (start) position of the k-mer. It means that two same gapped k-mers that start at different positions of a given sequence are considered to be different, as opposed to (non-positional) gapped k-mers.</p>
<p>A user specifies the length of each gap using <code>kmer_gaps</code> parameter. The other function parameters should be <code>k = length(kmer_gaps) + 1</code> (default) and <code>positional = TRUE</code>.</p>
<p>For example, positional gapped 3-mers with gaps’ lengths 0 and 1 of sequence AABCCA are: 1_AAC, 2_ABC, 3_BCA.</p>
<div id="usage-3" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-3" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"DDDVSVAA"</span>, <span class="st">"FFSFSVAAA"</span><span class="op">)</span>,
            kmer_gaps<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">2</span>, <span class="fl">0</span><span class="op">)</span>, <span class="co"># gapped 3-mer template: X__XX</span>
            positional<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 9 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      1_D.V.S_2.0 3_D.V.A_2.0 2_D.S.V_2.0 4_V.A.A_2.0 2_F.S.V_2.0 4_F.A.A_2.0</span>
<span class="co">#&gt; [1,]           1           1           1           1           .           .</span>
<span class="co">#&gt; [2,]           .           .           .           .           1           1</span>
<span class="co">#&gt;      3_S.V.A_2.0 5_S.A.A_2.0 1_F.F.S_2.0</span>
<span class="co">#&gt; [1,]           .           .           .</span>
<span class="co">#&gt; [2,]           1           1           1</span></code></pre></div>
</div>
</div>
</div>
<div id="result-type" class="section level2">
<h2 class="hasAnchor">
<a href="#result-type" class="anchor"></a>Result type</h2>
<p>The result of the k-mer counting function is a k-mer matrix, represented as a <strong>sparse matrix</strong> (see <a href="https://CRAN.R-project.org/package=Matrix">package Matrix</a>).</p>
<p>The i-th row of the result matrix corresponds to the i-th input sequence and contains the information about particular occurrences of k-mers. On the other hand, columns correspond to k-mers found in input sequences and they are represented in a human-readable form (for more detail see section <code>Human-readable representation of k-mers</code>).</p>
<p>Due to the usage of a sparse matrix representation, a signification memory optimization is achieved, as it can be seen below.</p>
<div class="sourceCode" id="cb7"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">get_random_string_vector</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">seq_num</span>, <span class="va">seq_len</span>, <span class="va">alphabet</span>, <span class="va">seed</span><span class="op">=</span><span class="fl">123</span><span class="op">)</span> <span class="op">{</span>
  <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span>
  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">sapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="va">seq_num</span>,
         <span class="kw">function</span><span class="op">(</span><span class="va">n</span><span class="op">)</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample</a></span><span class="op">(</span><span class="va">alphabet</span>, <span class="va">seq_len</span>, replace<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>, collapse<span class="op">=</span><span class="st">""</span><span class="op">)</span><span class="op">)</span>
<span class="op">}</span>

<span class="va">r</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu">get_random_string_vector</span><span class="op">(</span><span class="fl">300</span>, <span class="fl">1000</span>, <span class="va">LETTERS</span><span class="op">)</span>,
                 k<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html">object_size</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 20.3 MB</span>
<span class="fu"><a href="https://rdrr.io/r/base/print.html">print</a></span><span class="op">(</span><span class="fu">pryr</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/pryr/man/object_size.html">object_size</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/matrix.html">as.matrix</a></span><span class="op">(</span><span class="va">r</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 543 MB</span></code></pre></div>
<p>Importantly, such a representation is supported by machine learning packages such as <a href="https://CRAN.R-project.org/package=ranger">ranger</a> and <a href="https://CRAN.R-project.org/package=xgboost">xgboost</a>. Therefore, in those cases, it does not require extra conversions.</p>
</div>
<div id="extra-features" class="section level2">
<h2 class="hasAnchor">
<a href="#extra-features" class="anchor"></a>Extra features</h2>
<p>In order to improve user experience and meet custom needs, several extra features are provided.</p>
<div id="configurable-k-mer-alphabet" class="section level3">
<h3 class="hasAnchor">
<a href="#configurable-k-mer-alphabet" class="anchor"></a>Configurable k-mer alphabet</h3>
<p>A k-mer alphabet defines which elements of a sequence should be considered during the k-mer counting procedure.</p>
<p>By default, alphabet derived from input sequences is used:</p>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VAAAAHDFAA"</span>, <span class="st">"KKKKAKAAVA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">4</span><span class="op">)</span>
<span class="co">#&gt; 2 x 14 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 14 column names 'A.A.H.D_0.0.0', 'A.A.A.A_0.0.0', 'A.A.A.H_0.0.0' ... ]]</span>
<span class="co">#&gt;                                 </span>
<span class="co">#&gt; [1,] 1 1 1 1 1 1 1 . . . . . . .</span>
<span class="co">#&gt; [2,] . . . . . . . 1 1 1 1 1 1 1</span></code></pre></div>
<p>However, a user can provide a custom k-mer alphabet (<code><a href="https://rdrr.io/r/base/c.html">c("A", "K")</a></code>):</p>
<div class="sourceCode" id="cb9"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VAAAAHDFAA"</span>, <span class="st">"KKKKAKAAVA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">4</span>,
            kmer_alphabet <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"A"</span>, <span class="st">"K"</span><span class="op">)</span><span class="op">)</span>
<span class="co">#&gt; 2 x 6 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      A.A.A.A_0.0.0 A.K.A.A_0.0.0 K.A.K.A_0.0.0 K.K.A.K_0.0.0 K.K.K.K_0.0.0</span>
<span class="co">#&gt; [1,]             1             .             .             .             .</span>
<span class="co">#&gt; [2,]             .             1             1             1             1</span>
<span class="co">#&gt;      K.K.K.A_0.0.0</span>
<span class="co">#&gt; [1,]             .</span>
<span class="co">#&gt; [2,]             1</span></code></pre></div>
</div>
<div id="configurable-batch-size" class="section level3">
<h3 class="hasAnchor">
<a href="#configurable-batch-size" class="anchor"></a>Configurable batch size</h3>
<p>The internal algorithm processes input sequences in consecutive batches of a given size. The larger the size of a batch is, the more sequences will be used in a single step that processes entries concurrently. Therefore, a user should be aware that in order to take full advantage of multi-threading, they should set the batch size to the number that is greater or equal to the number of CPU cores. However, simultaneously, this number should not be too large in order not to consume too much memory, as during a single step, all sequences of a given batch are encoded, which, in turn, increases memory usage additionally.</p>
<p>Generally, there are two common use cases when a user should explicitly set the size of a batch size (in other cases, the default value is sufficient): 1. a user does not want to process sequences concurrently (then, they should set <code>batch_size = 1</code>) 2. a user needs to tweak the memory consumption accordingly to their custom needs</p>
<div id="usage-4" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-4" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">sequences</span> <span class="op">&lt;-</span> <span class="fu">get_random_string_vector</span><span class="op">(</span>seq_num <span class="op">=</span> <span class="fl">200</span>, seq_len <span class="op">=</span> <span class="fl">1000</span>, alphabet <span class="op">=</span> <span class="va">LETTERS</span><span class="op">)</span>
<span class="fu">microbenchmark</span><span class="fu">::</span><span class="fu"><a href="https://rdrr.io/pkg/microbenchmark/man/microbenchmark.html">microbenchmark</a></span><span class="op">(</span>
  multithreaded <span class="op">=</span> <span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="va">sequences</span>, k<span class="op">=</span><span class="fl">5</span>, batch_size <span class="op">=</span> <span class="fl">200</span><span class="op">)</span>,
  singlethreaded <span class="op">=</span> <span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="va">sequences</span>, k<span class="op">=</span><span class="fl">5</span>, batch_size <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,
  times<span class="op">=</span><span class="fl">11</span>
<span class="op">)</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Unit: milliseconds</span>
<span class="co">#&gt;            expr      min      lq     mean   median       uq      max neval</span>
<span class="co">#&gt;   multithreaded 154.1921 162.223 168.1859 163.7308 165.0471 222.0474    11</span>
<span class="co">#&gt;  singlethreaded 223.1620 226.276 230.7504 230.7760 235.7555 237.7434    11</span></code></pre></div>
</div>
</div>
<div id="verbose-mode" class="section level3">
<h3 class="hasAnchor">
<a href="#verbose-mode" class="anchor"></a>Verbose mode</h3>
<p>Verbose mode allows a user to get extra information about the current state of computations, e.g., which batch of sequences is currently processed.</p>
<div id="usage-5" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-5" class="anchor"></a>Usage</h4>
<div class="sourceCode" id="cb11"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VAAAAHDFAA"</span>, <span class="st">"KKKKAKAAVA"</span>, <span class="st">"ASDDA"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">3</span>,
            batch_size<span class="op">=</span><span class="fl">1</span>,
            verbose <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; Single-threaded mode enabled. In order to speed up computations, increase defined batch_size or use a default value</span>
<span class="co">#&gt; Start processing sequences (batch: [1-1])...</span>
<span class="co">#&gt; Start processing sequences (batch: [2-2])...</span>
<span class="co">#&gt; Start processing sequences (batch: [3-3])...</span>
<span class="co">#&gt; 3 x 17 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 17 column names 'A.H.D_0.0', 'H.D.F_0.0', 'A.A.H_0.0' ... ]]</span>
<span class="co">#&gt;                                       </span>
<span class="co">#&gt; [1,] 1 1 1 1 2 1 1 . . . . . . . . . .</span>
<span class="co">#&gt; [2,] . . . . . . . 1 1 2 1 1 1 1 . . .</span>
<span class="co">#&gt; [3,] . . . . . . . . . . . . . . 1 1 1</span></code></pre></div>
</div>
</div>
<div id="configurable-dimension-of-the-hash-value-of-a-k-mer" class="section level3">
<h3 class="hasAnchor">
<a href="#configurable-dimension-of-the-hash-value-of-a-k-mer" class="anchor"></a>Configurable dimension of the hash value of a k-mer</h3>
<p>As the core k-mer counting algorithm intensively takes advantage of hashing functions, <code>seqR</code> package is a probabilistic solution. However, due to the application of multi-dimensional hash values, a user can specify the length of the hash vector, and, thus, increase the probability of a correct result.</p>
<p>Nevertheless, for small values of <code>k</code> (<code>k &lt;= 10</code>), the result is certainly correct for the default value of the parameter (i.e., <code>hash_size = 2</code>).</p>
</div>
<div id="compute-k-mers-with-or-without-their-frequencies" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-k-mers-with-or-without-their-frequencies" class="anchor"></a>compute k-mers with or without their frequencies</h3>
<p>This feature is particularly useful when a user only wants to get information related to presence or absence of k-mers. Then, they might set this feature (<code>with_kmer_counts = FALSE</code>).</p>
<div id="usage-6" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-6" class="anchor"></a>Usage</h4>
<p>Compare the following two code snippets:</p>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">3</span>,
            with_kmer_counts<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 11 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 11 column names 'A.D.F_0.0', 'A.A.D_0.0', 'S.S.A_0.0' ... ]]</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; [1,] 1 1 1 1 1 1 1 . . . .</span>
<span class="co">#&gt; [2,] . 1 . . . . . 1 1 1 1</span></code></pre></div>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">3</span>,
            with_kmer_counts<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 11 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 11 column names 'A.D.F_0.0', 'A.A.D_0.0', 'S.S.A_0.0' ... ]]</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; [1,] 1 1 1 1 1 1 7 . . . .</span>
<span class="co">#&gt; [2,] . 1 . . . . . 4 3 1 1</span></code></pre></div>
</div>
</div>
<div id="compute-a-result-k-mer-matrix-with-or-without-human-readable-k-mer-column-names" class="section level3">
<h3 class="hasAnchor">
<a href="#compute-a-result-k-mer-matrix-with-or-without-human-readable-k-mer-column-names" class="anchor"></a>Compute a result k-mer matrix with or without human-readable k-mer (column) names</h3>
<p>The aim of this feature is to optimize memory consumption and CPU time. It is particularly useful when many different k-mer models are tested and there is no need to get a human-readable features.</p>
<div id="usage-7" class="section level4">
<h4 class="hasAnchor">
<a href="#usage-7" class="anchor"></a>Usage</h4>
<p>Compare the following two code snippets:</p>
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">3</span>,
            with_kmer_names<span class="op">=</span><span class="cn">FALSE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 11 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; [1,] 1 1 1 1 1 1 7 . . . .</span>
<span class="co">#&gt; [2,] . 1 . . . . . 4 3 1 1</span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
            k<span class="op">=</span><span class="fl">3</span>,
            with_kmer_names<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; 2 x 11 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 11 column names 'A.D.F_0.0', 'A.A.D_0.0', 'S.S.A_0.0' ... ]]</span>
<span class="co">#&gt;                           </span>
<span class="co">#&gt; [1,] 1 1 1 1 1 1 7 . . . .</span>
<span class="co">#&gt; [2,] . 1 . . . . . 4 3 1 1</span></code></pre></div>
</div>
</div>
<div id="count-k-mers-of-several-types-in-a-single-function-invocation" class="section level3">
<h3 class="hasAnchor">
<a href="#count-k-mers-of-several-types-in-a-single-function-invocation" class="anchor"></a>Count k-mers of several types in a single function invocation</h3>
<p>For the sake of convenient usage, an extra wrapper (<code>count_multimers</code>) has been implemented. It makes possible counting k-mers of various type using only a single invocation of a function. In this case, a user must provide sequences (rather than single values) that denote k-mer configurations (for more detail see the documentation of <code>count_multimers</code>).</p>
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="fu"><a href="../reference/count_multimers.html">count_multimers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
                k_vector<span class="op">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="fl">1</span>,<span class="fl">2</span>,<span class="fl">3</span>,<span class="fl">4</span><span class="op">)</span>,
                verbose<span class="op">=</span><span class="cn">TRUE</span><span class="op">)</span>
<span class="co">#&gt; [1] "Processing sequences for config no.1"</span>
<span class="co">#&gt; Start processing sequences (batch: [1-2])...</span>
<span class="co">#&gt; [1] "Processing sequences for config no.2"</span>
<span class="co">#&gt; Start processing sequences (batch: [1-2])...</span>
<span class="co">#&gt; [1] "Processing sequences for config no.3"</span>
<span class="co">#&gt; Start processing sequences (batch: [1-2])...</span>
<span class="co">#&gt; [1] "Processing sequences for config no.4"</span>
<span class="co">#&gt; Start processing sequences (batch: [1-2])...</span>
<span class="co">#&gt; 2 x 37 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;    [[ suppressing 37 column names 'S', 'D', 'A' ... ]]</span>
<span class="co">#&gt;                                                                                </span>
<span class="co">#&gt; [1,] 2 1 11 1 1 1 1 9 1 1 . . 1 1 1 1 1 1 7 . . . . 1 5 1 1 1 1 1 1 . . . . . .</span>
<span class="co">#&gt; [2,] . 6  6 . . . . 1 5 . 1 4 . 1 . . . . . 4 3 1 1 . . . . . . . . 1 2 1 1 1 3</span></code></pre></div>
</div>
<div id="merge-rbind-two-k-mer-matrices-derived-from-distinct-sequences" class="section level3">
<h3 class="hasAnchor">
<a href="#merge-rbind-two-k-mer-matrices-derived-from-distinct-sequences" class="anchor"></a>Merge (rbind) two k-mer matrices derived from distinct sequences</h3>
<p>As <code>rbind</code> function does not work correctly if input matrices does not have equivalent sets of columns, <code>seqR</code> package provides a new function (<code>rbind_columnwise</code>) to satisfy this use case:</p>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">mA</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"AAAAAAADFSSAAAA"</span>, <span class="st">"AADADADADDAD"</span><span class="op">)</span>,
                  k<span class="op">=</span><span class="fl">1</span><span class="op">)</span>
<span class="va">mB</span> <span class="op">&lt;-</span> <span class="fu"><a href="../reference/count_kmers.html">count_kmers</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"VVVVVAAVA"</span>, <span class="st">"ADSDDD"</span>, <span class="st">"AAAAAV"</span><span class="op">)</span>,
                  k<span class="op">=</span><span class="fl">1</span><span class="op">)</span>

<span class="fu"><a href="../reference/rbind_columnwise.html">rbind_columnwise</a></span><span class="op">(</span><span class="va">mA</span>, <span class="va">mB</span><span class="op">)</span>
<span class="co">#&gt; 5 x 5 sparse Matrix of class "dgCMatrix"</span>
<span class="co">#&gt;      S D  A F V</span>
<span class="co">#&gt; [1,] 2 1 11 1 .</span>
<span class="co">#&gt; [2,] . 6  6 . .</span>
<span class="co">#&gt; [3,] . .  3 . 6</span>
<span class="co">#&gt; [4,] 1 4  1 . .</span>
<span class="co">#&gt; [5,] . .  5 . 1</span></code></pre></div>
</div>
</div>
<div id="human-readable-representation-of-k-mers" class="section level2">
<h2 class="hasAnchor">
<a href="#human-readable-representation-of-k-mers" class="anchor"></a>Human-readable representation of k-mers</h2>
<p>Each column of the result represents a single k-mer that has the following form:</p>
<p><code>[p_]s₁.s₂....sₖ_g₁.g₂...gₖ₋₁</code></p>
<p>The first part (<code>[p_]</code>) is an integer that is used only in case of positional k-mers and it indicates the exact (start) position of the k-mer in a sequence. The second part (<code>s₁.s₂....sₖ</code>) represents consecutive elements of the k-mer. Finally, the last part (<code>g₁.g₂...gₖ₋₁</code>) represents the consecutive lengths of gaps. In particular, if contiguous k-mers are considered, all elements of this part is equal to 0 (e.g., <code>0.0.0</code> for 4-mers). Importantly, for 1-mers, this part is not present.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Jadwiga Słowik.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
